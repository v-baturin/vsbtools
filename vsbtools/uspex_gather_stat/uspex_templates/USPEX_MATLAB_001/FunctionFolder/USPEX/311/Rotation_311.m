function Rotation_311(Ind_No)

% updated by Qiang Zhu(2013/12/12)

global POOL_STRUC
global ORG_STRUC
global OFF_STRUC

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%% CREATING Mutants by mutation%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

goodMutant = 0;
count = 0;
while goodMutant ~= 1
    count = count + 1;
    if count > 50
       %disp('failed to do Rotation in 50 attempts, switch to Random');
       USPEXmessage(510,'',0);
       Random_311(Ind_No);
       break;
    end
   
    IND = chooseGoodComposition(ORG_STRUC.tournament, ORG_STRUC.paretoRanking, POOL_STRUC);

    %toRotate = find (ORG_STRUC.tournament>RandInt(1,1,[0,max(ORG_STRUC.tournament)-1]));
    %IND = toRotate(end);
    
    MtypeLIST = POOL_STRUC.POPULATION(IND).MtypeLIST;
    numMols   = POOL_STRUC.POPULATION(IND).numMols;
    lattice   = POOL_STRUC.POPULATION(IND).LATTICE;
    numIons   = POOL_STRUC.POPULATION(IND).numIons;
    numBlocks = POOL_STRUC.POPULATION(IND).numBlocks;
    typesAList= POOL_STRUC.POPULATION(IND).typesAList;
    ROTMOLS   = POOL_STRUC.POPULATION(IND).MOLECULES;

    [ROTMOLS,rotNow] = Rotation_Random(ROTMOLS, MtypeLIST);
    goodMutant =  newMolCheck(ROTMOLS, lattice, MtypeLIST, ORG_STRUC.minDistMatrice-0.2);
    if goodMutant == 1
        OFF_STRUC.POPULATION(Ind_No).MOLECULES = ROTMOLS;
        OFF_STRUC.POPULATION(Ind_No).LATTICE = lattice;
        OFF_STRUC.POPULATION(Ind_No).numIons = numIons;
        OFF_STRUC.POPULATION(Ind_No).numMols = numMols;
        OFF_STRUC.POPULATION(Ind_No).MtypeLIST = MtypeLIST;
        OFF_STRUC.POPULATION(Ind_No).typesAList = typesAList;
        OFF_STRUC.POPULATION(Ind_No).numBlocks = numBlocks;
        OFF_STRUC.POPULATION(Ind_No).howCome = '  Rotate  ';
        info_parents = struct('parent', {}, 'howManyRots', {}, 'enthalpy',{});
        info_parents(1).parent = num2str(POOL_STRUC.POPULATION(IND).Number);
        info_parents.enthalpy  = POOL_STRUC.POPULATION(IND).enthalpy;
        info_parents.howManyRots=rotNow;
        OFF_STRUC.POPULATION(Ind_No).Parents = info_parents;
        disp(['Structure ' num2str(Ind_No) '  generated by rotmutation']);
    end
end

%%%%%%%%%%%%%%% END creating mutants%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
