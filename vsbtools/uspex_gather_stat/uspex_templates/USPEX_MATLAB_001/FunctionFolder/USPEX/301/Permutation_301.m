function Permutation_301(Ind_No)

% USPEX Version 9.4.0

global POOL_STRUC
global  ORG_STRUC
global  OFF_STRUC

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%% CREATING mutants by permutation %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

goodMutant = 0;
count = 1;

while goodMutant  ~= 1
    count = count + 1;
    
    ind = chooseGoodComposition(ORG_STRUC.tournament, ORG_STRUC.paretoRanking, POOL_STRUC);

    if count > 50 || ind < 0
       %disp('failed to do mutation in 50 attempts, switch to Random');
       USPEXmessage(511,'',0);
       Random_301(Ind_No);
       break;
    end

    %toPerMutate = find(ORG_STRUC.tournament>RandInt(1,1,[0,max(ORG_STRUC.tournament)-1]));
    %ind = toPerMutate(end);
    
    % create a PERMUTANT. The swapIons_mutation simply swaps ions
    % of a different type
    LATTICE = POOL_STRUC.POPULATION(ind).LATTICE;
    father  = POOL_STRUC.POPULATION(ind).COORDINATES;
    numIons = POOL_STRUC.POPULATION(ind).numIons;
    order   = POOL_STRUC.POPULATION(ind).order;
    numBlocks = POOL_STRUC.POPULATION(ind).numBlocks;

    %goodComposition = CompositionCheck(numBlocks);
    %if goodComposition  %if not, we don't try
    [PERMUT,noOfSwapsNow] = swapIons_mutation_final(father, numIons, order);
    if noOfSwapsNow>0
       goodMutant = distanceCheck(PERMUT,LATTICE, numIons, ORG_STRUC.minDistMatrice);
    end
    %end
    if goodMutant  == 1
        disp(['Structure ' num2str(Ind_No) ' generated by permutation']);

        info_parents             = struct('parent', {},'noOfSwapsNow', {}, 'enthalpy', {});
        info_parents(1).parent   =num2str(POOL_STRUC.POPULATION(ind).Number);
        info_parents.enthalpy    =POOL_STRUC.POPULATION(ind).enthalpy;
        info_parents.noOfSwapsNow=noOfSwapsNow;

        OFF_STRUC.POPULATION(Ind_No).Parents     = info_parents;
        OFF_STRUC.POPULATION(Ind_No).COORDINATES =  PERMUT;
        OFF_STRUC.POPULATION(Ind_No).LATTICE     = LATTICE;
        OFF_STRUC.POPULATION(Ind_No).howCome     = 'Permutate';
        OFF_STRUC.POPULATION(Ind_No).numIons     = numIons;
        OFF_STRUC.POPULATION(Ind_No).numBlocks   = numBlocks;

    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% END creating mutants %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

